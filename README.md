<div dir="rtl" align="right">

<h1 align="center">Forestry & Trees 2024 🌳</h1>
<h3 align="center">מערכת BI לניתוח דוחות כריתה וערעורים – "רחובות של עצים"</h3>

ברוכים הבאים למערכת **Forestry & Trees 2024** –  
ממשק BI אינטראקטיבי לניתוח דוחות כריתה ודוחות ערעורים של פרויקט **"רחובות של עצים"**, בצורה נוחה, ויזואלית ומוכנה למצגות.

המערכת מאפשרת:

- 🧩 **מיזוג וניקוי נתונים** מדוחות כריתה גולמיים.
- 📊 **ניתוח BI לדוחות כריתה** – לפי יישובים, מיני עץ, שנים, אזורים וסיבות כריתה.
- 📝 **ניתוח BI לדוחות ערעורים** – אחוזי הצלחה, עצים שניצלו לשימור, יישובים מובילים ועוד.
- 📁 **הכנת נתונים ל-Power BI / Excel / כלי BI נוספים** בקובץ אחיד ונקי.

---

<h2 align="center">📚 תוכן עניינים</h2>

<ol>
  <li>מה המערכת עושה?</li>
  <li>מסלול עבודה מומלץ (Flow)</li>
  <li>מודולים מרכזיים במערכת</li>
  <li>אילו קבצים נדרשים?</li>
  <li>איך להכין את קבצי האקסל – שלב אחר שלב</li>
  <li>הרצת המיזוג – דף 🧩 Merge & Export</li>
  <li>עבודה עם קובץ המיזוג – דף 📊 BI דוחות כריתה</li>
  <li>ניתוח דוחות ערעורים – דף 📝 BI ערעורים</li>
  <li>סיכום מסלול עבודה</li>
  <li>התקנה והרצה טכנית (Python + Streamlit)</li>
  <li>הפרויקט, שותפים ושימושים</li>
  <li>רעיונות לשיפור עתידי</li>
</ol>

---

<h2 align="center">🔎 מה המערכת עושה?</h2>

**Forestry & Trees 2024** מיועדת לשלושה שימושים עיקריים:

<ol>
  <li>
    <b>מיזוג וניקוי נתונים</b><br>
    איחוד כל דוחות הכריתה לקובץ אחד מאוחד, פיענוח קודים (יישוב, מין עץ, פעולה, סיבה), תיקון תאריכים וניקוי רשומות בעייתיות.
  </li>
  <li>
    <b>יצירת קובץ BI מאוחד לכריתה</b><br>
    הפקת קובץ מרכזי: <code>merged_forest_reports_FINAL_dates_fixed.xlsx</code><br>
    הקובץ מותאם לעבודה עם: Streamlit, Power BI, Excel (Pivot Tables) וכל כלי BI נוסף.
  </li>
  <li>
    <b>ניתוח BI לדוחות כריתה ודוחות ערעורים</b><br>
    דף BI לכריתה: TOP-יישובים, TOP-מיני עץ, פילוחים לפי זמן/אזור/סיבה.<br>
    דף BI לערעורים: אחוזי הצלחה, עצים שניצלו לשימור, יישובים מובילים ועוד.
  </li>
</ol>

---

<h2 align="center">🧭 מסלול עבודה מומלץ (Flow)</h2>

מסלול הזרימה המומלץ:

> **🧩 Merge & Export → 📊 BI כריתה → 📝 BI ערעורים**

<ol>
  <li>
    <b>🧩 Merge & Export – מיזוג ופיענוח</b><br>
    מיזוג כל גליונות הכריתה לקובץ אחד, המרת קודים (יישוב / עץ), פיענוח פעולה/סיבה ותיקון תאריכים.<br>
    התוצאה: <code>merged_forest_reports_FINAL_dates_fixed.xlsx</code> – קובץ מוכן ל-BI.
  </li>
  <li>
    <b>📊 BI – דוחות כריתה</b><br>
    ניתוח ויזואלי של כריתות: TOP-יישובים, TOP-מיני עץ, פילוח לפי שנים, אזורים וסיבות כריתה, כולל גרפים אינטראקטיביים וייצוא ל-PNG / CSV.
  </li>
  <li>
    <b>📝 BI – דוחות ערעורים</b><br>
    ניתוח ערעורים: אחוזי הצלחה, עצים שניצלו לשימור, יישובים מובילים, סיבות ערעור וסטטוס החלטה.
  </li>
  <li>
    <b>📘 מדריך שימוש</b><br>
    הסבר מרוכז: אילו קבצים צריך, איך להכין אותם באקסל, ואיך לעבוד בכל דף במערכת.
  </li>
</ol>

---

<h2 align="center">🧩 מודולים מרכזיים במערכת</h2>

- **🧩 Merge & Export – מיזוג ופיענוח**
  - מיזוג כל גליונות הכריתה לקובץ אחד.
  - מיפוי עמודות לשמות אחידים (Standard Schema).
  - פיענוח קודי יישוב / עץ.
  - תיקון תאריכים ויצירת דגלים (`__is_cut__`, `__is_move__`).

- **📊 BI – דוחות כריתה**
  - ניתוח נתוני כריתה:
    - TOP-10 יישובים בכמות כריתות.
    - TOP-10 מיני עץ שנכרתו.
    - פילוח לפי סיבות, אזורים וטווחי תאריכים.

- **📝 BI – דוחות ערעורים**
  - ניתוח ערעורים:
    - אחוזי הצלחה.
    - יישובים מובילים בערעורים.
    - עצים שניצלו לשימור.
    - פילוח לפי סטטוס החלטה וסיבת ערעור.

- **📘 מדריך שימוש**
  - הסבר מלא על הכנת הקבצים, הרצת המיזוג ושימוש בדפי ה-BI.

---

<h2 align="center">📂 אילו קבצים נדרשים?</h2>

כדי לעבוד עם המערכת באופן מלא, נדרשים ארבעה קבצים עיקריים:

<h3>1. דוחות כריתה מאוחדים</h3>

קובץ מקורי מהגוף הממשלתי, לדוגמה:  
`forestry_and_trees_report2024 דוחות כריתה אחוד.xlsx`

שכולל:

- מספר גליונות כריתה לפי אזורים/מחוזות.
- גיליון **"רשימת ערים לפי קודים"**.
- גיליון **"רשימת עצים לפי קודים"**.

<h3>2. קובצי רשימות ייעודיים (נוצרים אצלך)</h3>

<ol>
  <li>
    <b>קובץ דוחות כריתה מאוחדים (ללא גליונות רשימות)</b><br>
    לדוגמה: <code>forestry_and_trees_report2024 דוחות כריתה אחוד ללא הרשימות.xlsx</code>
  </li>
  <li>
    <b>קובץ רשימת ערים לפי קודים</b><br>
    לדוגמה: <code>רשימת ערים לפי קודים.xlsx</code><br>
    עם עמודות כגון: <code>ישוב</code>, <code>סמל ישוב</code>.
  </li>
  <li>
    <b>קובץ רשימת עצים לפי קודים</b><br>
    לדוגמה: <code>רשימת עצים לפי קודים.xlsx</code><br>
    עם עמודות כגון: <code>Tree</code> (קוד העץ), <code>שם עץ</code> (שם העץ בעברית).
  </li>
</ol>

<h3>3. קובץ דוחות ערעורים</h3>

קובץ נפרד לניתוח ערעורים, לדוגמה:  
`forestry_and_trees_ararim2024- דוח ערערים.xlsx`  
משמש לדף **📝 BI – דוחות ערעורים**.

> 💡 **טיפ ארגוני**  
> מומלץ ליצור תיקייה מסודרת, למשל:  
> `TreeProjectsBI/inputs`  
> ולשמור שם את כל 4 הקבצים:
> - דוחות כריתה מאוחדים (ללא רשימות)
> - רשימת ערים
> - רשימת עצים
> - דוח ערעורים

---

<h2 align="center">🧾 איך להכין את קבצי האקסל – שלב אחר שלב</h2>

<h3>1. פתיחת הקובץ המקורי</h3>

<ol>
  <li>פתח/י באקסל את הקובץ המקורי, לדוגמה:  
      <code>forestry_and_trees_report2024 דוחות כריתה אחוד.xlsx</code></li>
  <li>ודא/י שיש בו גליונות:
    <ul>
      <li><b>"רשימת ערים לפי קודים"</b></li>
      <li><b>"רשימת עצים לפי קודים"</b></li>
    </ul>
  </li>
</ol>

<h3>2. שמירת רשימת ערים לקובץ נפרד</h3>

<ol>
  <li>עמוד/י על הגיליון <b>"רשימת ערים לפי קודים"</b>.</li>
  <li>File → Save As → שמירת הקובץ בשם:  
      <code>רשימת ערים לפי קודים.xlsx</code></li>
  <li>ודא/י שהעמודות המרכזיות קיימות: <code>ישוב</code>, <code>סמל ישוב</code>.</li>
</ol>

<h3>3. שמירת רשימת עצים לקובץ נפרד</h3>

<ol>
  <li>חזור/י לקובץ המקורי.</li>
  <li>עבור/י לגיליון <b>"רשימת עצים לפי קודים"</b>.</li>
  <li>שמור/י כקובץ חדש בשם:  
      <code>רשימת עצים לפי קודים.xlsx</code></li>
  <li>ודא/י שיש בו עמודות: <code>Tree</code> (קוד העץ), <code>שם עץ</code> (שם העץ בעברית).</li>
</ol>

<h3>4. יצירת קובץ דוחות כריתה "ללא רשימות"</h3>

<ol>
  <li>בקובץ המקורי (הכולל גם רשימות) מחק/י או הסתר/י את הגיליונות:
    <ul>
      <li><b>"רשימת ערים לפי קודים"</b></li>
      <li><b>"רשימת עצים לפי קודים"</b></li>
    </ul>
  </li>
  <li>שמור/י כעותק חדש בשם לדוגמה:  
      <code>forestry_and_trees_report2024 דוחות כריתה אחוד ללא הרשימות.xlsx</code></li>
  <li>קובץ זה ישמש כקובץ הדוחות הראשי בדף <b>🧩 Merge & Export</b>.</li>
</ol>

---

<h2 align="center">🧩 הרצת המיזוג – דף 🧩 Merge & Export</h2>

בסרגל הצד של Streamlit בחר/י:

> **🧩 Merge & Export**

<h3>1. העלאת הקבצים</h3>

במסך המיזוג תופיע טופסת העלאה עם שלושה שדות:

<ol>
  <li>קובץ דוחות כריתה מאוחדים ללא גליונות רשימות  
      <code>forestry_and_trees_report2024 דוחות כריתה אחוד ללא הרשימות.xlsx</code></li>
  <li><code>רשימת ערים לפי קודים.xlsx</code></li>
  <li><code>רשימת עצים לפי קודים.xlsx</code></li>
</ol>

לאחר בחירת שלושת הקבצים לחץ/י על:

> **🚀 הרץ מיזוג והמרות**

<h3>2. מה המנוע עושה בזמן הריצה?</h3>

- קריאה של **כל גליונות הכריתה** בקובץ הראשי.
- איתור אוטומטי של שורת הכותרת גם אם:
  - שורה 1 היא כותרת כללית.
  - שורה 2 ריקה.
  - הכותרות האמיתיות מופיעות בשורה 3/4.
- מיפוי עמודות לשמות אחידים:
  - אזור, יישוב, שם מין עץ, תאריכים (`מ-תאריך`, `עד-תאריך`), פעולה, סיבה ועוד.
- המרה:
  - **קודי יישוב → שם יישוב** (בעזרת קובץ רשימת ערים).
  - **קודי עץ → שם מין עץ** (בעזרת קובץ רשימת עצים).
- פיענוח:
  - `פעולה` → `פעולה_מפוענחת` (כריתה / העתקה).
  - `סיבה` → `סיבה_מפוענחת` (בטיחות, בנייה, עץ מת, וכד').
- יצירת דגלים:
  - `__is_cut__` – האם השורה מייצגת כריתה.
  - `__is_move__` – האם מדובר בהעתקה/שימור.

<h3>3. תוצאה – קובץ BI מוכן</h3>

בסיום התהליך יופיע כפתור הורדה לקובץ:

> `merged_forest_reports_FINAL_dates_fixed.xlsx`

זהו **קובץ הליבה** שמשמש את דף **📊 BI – דוחות כריתה**,  
וכן יכול לשמש כקלט ל-Power BI, Excel ועוד.

---

<h2 align="center">📊 עבודה עם קובץ המיזוג – דף 📊 BI דוחות כריתה</h2>

בצד ימין (Sidebar) בחר/י:

> **📊 BI – דוחות כריתה**

במסך זה תמצא/י:

1. **רכיב העלאת קובץ**
   - העלה/י את `merged_forest_reports_FINAL_dates_fixed.xlsx`.

2. **מסננים (פילטרים)**
   - שנה.
   - יישוב.
   - סוג פעולה (כריתה / העתקה).
   - סיבה (בטיחות / בנייה / אחר).
   - אזור / מחוז ועוד.

3. **גרפים ו-TOP-10**
   - TOP-10 יישובים בכמות כריתות  
     (ספירה על בסיס `__is_cut__ = True`).
   - TOP-10 מיני עץ שנכרתו.
   - פילוח לפי:
     - סיבה.
     - אזור.
     - טווחי תאריכים.

ניתן:

- לסנן לפי שנה / יישוב / סיבה.
- להוריד גרפים כ-PNG למצגות.
- להוריד CSV מסונן להמשך ניתוח.

---

<h2 align="center">📝 ניתוח דוחות ערעורים – דף 📝 BI ערעורים</h2>

בצד ימין בחר/י:

> **📝 BI – דוחות ערעורים**

במסך זה תמצא/י:

1. **רכיב העלאת קובץ ערעורים**
   - לדוגמה:  
     `forestry_and_trees_ararim2024- דוח ערערים.xlsx`

2. **מנגנון עיבוד אוטומטי המזהה:**
   - תאריך הערעור.
   - יישוב (מתוך כתובת/טקסט).
   - סיבת הערעור:
     - בנייה.
     - בטיחות.
     - מטרד.
     - אחר.
   - סטטוס ההחלטה:
     - התקבל.
     - התקבל חלקית.
     - נדחה.
     - לא נדון.
   - מספר עצים לשימור שניצלו.

3. **תוצרים ויזואליים:**
   - TOP-10 יישובים בכמות ערעורים.
   - יישובים מובילים בהצלחת ערעורים.
   - אחוזי הצלחה לפי סיבת ערעור.
   - רשימת ערעורים "גדולים" שהצילו הכי הרבה עצים.

---

<h2 align="center">🧭 סיכום מסלול עבודה</h2>

<ol>
  <li><b>איסוף קבצים</b> – ודא/י שכל ארבעת הקבצים קיימים:
    <ul>
      <li>דוחות כריתה מאוחדים ללא רשימות.</li>
      <li>רשימת ערים לפי קודים.</li>
      <li>רשימת עצים לפי קודים.</li>
      <li>דוח ערעורים.</li>
    </ul>
  </li>
  <li><b>הכנת הקבצים</b> – הפרדת רשימות ערים/עצים לקבצים נפרדים, ויצירת קובץ דוחות כריתה ללא גליונות רשימות.</li>
  <li><b>🧩 Merge & Export</b> – העלאת 3 קבצי הכריתה, הרצת המיזוג והורדת <code>merged_forest_reports_FINAL_dates_fixed.xlsx</code>.</li>
  <li><b>📊 BI – כריתה</b> – טעינת קובץ המיזוג, ניתוח דוחות הכריתה וייצוא גרפים/CSV.</li>
  <li><b>📝 BI – ערעורים</b> – טעינת דוח הערעורים, ניתוח החלטות, הצלחות ושימור עצים.</li>
  <li><b>שילוב בדוחות והצגות</b> – שימוש בגרפים במצגות ובקובצי CSV/Excel/Power BI לעבודה מתקדמת.</li>
</ol>

---

<h2 align="center">⚙️ התקנה והרצה טכנית (Python + Streamlit)</h2>
python -m venv .venv
# Windows
.venv\Scripts\activate
# Linux / macOS
source .venv/bin/activate

pip install -r requirements.txt

python -m streamlit run 1_HOME.py     מריץ את התוכנית מדף הבית 


