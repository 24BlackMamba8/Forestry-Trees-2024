<div dir="rtl" align="right">

# Forestry & Trees 2024 🌳  
**מערכת BI לניתוח דוחות כריתה וערעורים – "רחובות של עצים"**

ברוכים הבאים למערכת **Forestry & Trees 2024** –  
ממשק BI אינטראקטיבי לניתוח דוחות כריתה ודוחות ערעורים של פרויקט **"רחובות של עצים"**, בצורה נוחה, ויזואלית ומוכנה למצגות.

המערכת מאפשרת:

- 🧩 **מיזוג וניקוי נתונים** מדוחות כריתה גולמיים.
- 📊 **ניתוח BI לדוחות כריתה** – לפי יישובים, מיני עץ, שנים, אזורים וסיבות כריתה.
- 📝 **ניתוח BI לדוחות ערעורים** – אחוזי הצלחה, עצים שניצלו לשימור, יישובים מובילים ועוד.
- 📁 **הכנת נתונים ל-Power BI / Excel / כלי BI נוספים** בקובץ אחיד ונקי.

---

## 📚 תוכן עניינים

1. מה המערכת עושה?
2. מסלול עבודה מומלץ (Flow)
3. מודולים מרכזיים במערכת
4. אילו קבצים נדרשים?
5. איך להכין את קבצי האקסל – שלב אחר שלב
6. הרצת המיזוג – דף 🧩 Merge & Export
7. עבודה עם קובץ המיזוג – דף 📊 BI דוחות כריתה
8. ניתוח דוחות ערעורים – דף 📝 BI ערעורים
9. סיכום מסלול עבודה
10. התקנה והרצה טכנית (Python + Streamlit)
11. הפרויקט, שותפים ושימושים
12. רעיונות לשיפור עתידי

---

## 🔎 מה המערכת עושה?

**Forestry & Trees 2024** מיועדת לשלושה שימושים עיקריים:

1. **מיזוג וניקוי נתונים**
   - איחוד כל דוחות הכריתה לקובץ אחד מאוחד.
   - פיענוח קודים (יישוב, מין עץ, פעולה, סיבה).
   - תיקון תאריכים וניקוי רשומות בעייתיות.

2. **יצירת קובץ BI מאוחד לכריתה**
   - הפקת קובץ מרכזי:  
     `merged_forest_reports_FINAL_dates_fixed.xlsx`  
   - הקובץ מותאם לעבודה עם:
     - Streamlit
     - Power BI
     - Excel (Pivot Tables)
     - וכל כלי BI נוסף.

3. **ניתוח BI לדוחות כריתה ודוחות ערעורים**
   - דף BI לכריתה: TOP-יישובים, TOP-מיני עץ, פילוחים לפי זמן/אזור/סיבה.
   - דף BI לערעורים: אחוזי הצלחה, עצים שניצלו לשימור, יישובים מובילים ועוד.

---

## 🧭 מסלול עבודה מומלץ (Flow)

מסלול הזרימה המומלץ:

> **🧩 Merge & Export → 📊 BI כריתה → 📝 BI ערעורים**

1. **🧩 Merge & Export – מיזוג ופיענוח**
   - מיזוג כל גליונות הכריתה לקובץ אחד.
   - המרת קודים (יישוב / עץ).
   - פיענוח פעולה/סיבה.
   - תיקון תאריכים.
   - תוצאה:  
     `merged_forest_reports_FINAL_dates_fixed.xlsx` – קובץ מוכן ל-BI.

2. **📊 BI – דוחות כריתה**
   - ניתוח ויזואלי של כריתות:
     - TOP-יישובים.
     - TOP-מיני עץ.
     - פילוח לפי שנים, אזורים, סיבות כריתה.
   - גרפים אינטראקטיביים + אפשרות ייצוא ל-PNG / CSV.

3. **📝 BI – דוחות ערעורים**
   - ניתוח ערעורים:
     - אחוזי הצלחה.
     - עצים שניצלו לשימור.
     - יישובים מובילים.
     - סיבות ערעור וסטטוס החלטה.

4. **📘 מדריך שימוש**
   - הסבר מרוכז: אילו קבצים צריך, איך להכין אותם באקסל, ואיך לעבוד בכל דף במערכת.

---

## 🧩 מודולים מרכזיים במערכת

- **🧩 Merge & Export – מיזוג ופיענוח**
  - מיזוג כל גליונות הכריתה לקובץ אחד.
  - מיפוי עמודות לשמות אחידים (Standard Schema).
  - פיענוח קודי יישוב / עץ.
  - תיקון תאריכים ויצירת דגלים (`__is_cut__`, `__is_move__`).

- **📊 BI – דוחות כריתה**
  - ניתוח נתוני כריתה:
    - TOP-10 יישובים בכמות כריתות.
    - TOP-10 מיני עץ שנכרתו.
    - פילוח לפי סיבות, אזורים, טווחי תאריכים ועוד.

- **📝 BI – דוחות ערעורים**
  - ניתוח ערעורים:
    - אחוזי הצלחה.
    - יישובים מובילים בערעורים.
    - עצים שניצלו לשימור.
    - פילוח לפי סטטוס החלטה וסיבת ערעור.

- **📘 מדריך שימוש**
  - הסבר מלא על:
    - הכנת הקבצים.
    - הרצת המיזוג.
    - שימוש בדפי ה-BI.

---

## 📂 אילו קבצים נדרשים?

כדי לעבוד עם המערכת באופן מלא, נדרשים ארבעה קבצים עיקריים:

### 1. דוחות כריתה מאוחדים

קובץ מקורי מהגוף הממשלתי, לדוגמה:  
`forestry_and_trees_report2024 דוחות כריתה אחוד.xlsx`

שכולל:

- מספר גליונות כריתה לפי אזורים/מחוזות.
- גיליון **"רשימת ערים לפי קודים"**.
- גיליון **"רשימת עצים לפי קודים"**.

### 2. קובצי רשימות ייעודיים (נוצרים אצלך)

שלושה קבצים נפרדים:

1. **קובץ דוחות כריתה מאוחדים (ללא גליונות רשימות)**  
   לדוגמה:  
   `forestry_and_trees_report2024 דוחות כריתה אחוד ללא הרשימות.xlsx`

2. **קובץ רשימת ערים לפי קודים** – לדוגמה:  
   `רשימת ערים לפי קודים.xlsx`  
   עם עמודות כגון: `ישוב`, `סמל ישוב`.

3. **קובץ רשימת עצים לפי קודים** – לדוגמה:  
   `רשימת עצים לפי קודים.xlsx`  
   עם עמודות כגון: `Tree` (קוד העץ), `שם עץ` (שם העץ בעברית).

### 3. קובץ דוחות ערעורים

קובץ נפרד לניתוח ערעורים, לדוגמה:  
`forestry_and_trees_ararim2024- דוח ערערים.xlsx`  
משמש לדף **📝 BI – דוחות ערעורים**.

> 💡 **טיפ ארגוני**  
> מומלץ ליצור תיקייה מסודרת, למשל:  
> `TreeProjectsBI/inputs`  
> ולשמור שם את כל 4 הקבצים:
> - דוחות כריתה מאוחדים (ללא רשימות)
> - רשימת ערים
> - רשימת עצים
> - דוח ערעורים

---

## 🧾 איך להכין את קבצי האקסל – שלב אחר שלב

### 1. פתיחת הקובץ המקורי

1. פתח/י באקסל את הקובץ המקורי, לדוגמה:  
   `forestry_and_trees_report2024 דוחות כריתה אחוד.xlsx`
2. ודא/י שיש בו גליונות:
   - **"רשימת ערים לפי קודים"**
   - **"רשימת עצים לפי קודים"**

### 2. שמירת רשימת ערים לקובץ נפרד

1. עמוד/י על הגיליון **"רשימת ערים לפי קודים"**.
2. File → Save As → שמירת הקובץ בשם:  
   `רשימת ערים לפי קודים.xlsx`
3. ודא/י שהעמודות המרכזיות קיימות:
   - `ישוב`
   - `סמל ישוב`

### 3. שמירת רשימת עצים לקובץ נפרד

1. חזור/י לקובץ המקורי.
2. עבור/י לגיליון **"רשימת עצים לפי קודים"**.
3. שמור/י כקובץ חדש:  
   `רשימת עצים לפי קודים.xlsx`
4. ודא/י שיש בו עמודות:
   - `Tree` – קוד העץ.
   - `שם עץ` – שם העץ בעברית.

### 4. יצירת קובץ דוחות כריתה "ללא רשימות"

1. בקובץ המקורי (הכולל גם רשימות):
   - מחק/י או הסתר/י את הגיליונות:
     - **"רשימת ערים לפי קודים"**
     - **"רשימת עצים לפי קודים"**
   - שמור/י כעותק חדש בשם לדוגמה:  
     `forestry_and_trees_report2024 דוחות כריתה אחוד ללא הרשימות.xlsx`
2. זה יהיה **קובץ הדוחות הראשי** שתעלה/י לדף **🧩 Merge & Export**.

---

## 🧩 הרצת המיזוג – דף 🧩 Merge & Export

בסרגל הצד של Streamlit בחר/י:

> **🧩 Merge & Export**

### 1. העלאת הקבצים

במסך המיזוג תופיע טופסת העלאה עם שלושה שדות:

1. קובץ דוחות כריתה מאוחדים ללא גליונות רשימות  
   `forestry_and_trees_report2024 דוחות כריתה אחוד ללא הרשימות.xlsx`
2. `רשימת ערים לפי קודים.xlsx`
3. `רשימת עצים לפי קודים.xlsx`

לאחר בחירת שלושת הקבצים לחץ/י על:

> **🚀 הרץ מיזוג והמרות**

### 2. מה המנוע עושה בזמן הריצה?

- קריאה של **כל גליונות הכריתה** בקובץ הראשי.
- איתור אוטומטי של שורת הכותרת גם אם:
  - שורה 1 היא כותרת כללית.
  - שורה 2 ריקה.
  - הכותרות האמיתיות מופיעות בשורה 3/4.
- מיפוי עמודות לשמות אחידים:
  - אזור, יישוב, שם מין עץ, תאריכים (`מ-תאריך`, `עד-תאריך`), פעולה, סיבה ועוד.
- המרה:
  - **קודי יישוב → שם יישוב** (בעזרת קובץ רשימת ערים).
  - **קודי עץ → שם מין עץ** (בעזרת קובץ רשימת עצים).
- פיענוח:
  - `פעולה` → `פעולה_מפוענחת` (כריתה / העתקה).
  - `סיבה` → `סיבה_מפוענחת` (בטיחות, בנייה, עץ מת, וכד').
- יצירת דגלים:
  - `__is_cut__` – האם השורה מייצגת כריתה.
  - `__is_move__` – האם מדובר בהעתקה/שימור.

### 3. תוצאה – קובץ BI מוכן

בסיום התהליך יופיע כפתור הורדה לקובץ:

> `merged_forest_reports_FINAL_dates_fixed.xlsx`

זהו **קובץ הליבה** שמשמש את דף **📊 BI – דוחות כריתה**,  
וכן יכול לשמש כקלט ל-Power BI, Excel ועוד.

---

## 📊 עבודה עם קובץ המיזוג – דף 📊 BI דוחות כריתה

בצד ימין (Sidebar) בחר/י:

> **📊 BI – דוחות כריתה**

במסך זה תמצא/י:

1. **רכיב העלאת קובץ**
   - העלה/י את `merged_forest_reports_FINAL_dates_fixed.xlsx`.

2. **מסננים (פילטרים)**
   - שנה.
   - יישוב.
   - סוג פעולה (כריתה / העתקה).
   - סיבה (בטיחות / בנייה / אחר).
   - אזור / מחוז ועוד.

3. **גרפים ו-TOP-10**
   - TOP-10 יישובים בכמות כריתות  
     (ספירה על בסיס `__is_cut__ = True`).
   - TOP-10 מיני עץ שנכרתו.
   - פילוח לפי:
     - סיבה.
     - אזור.
     - טווחי תאריכים.

ניתן:

- לסנן לפי שנה / יישוב / סיבה.
- להוריד גרפים כ-PNG למצגות.
- להוריד CSV מסונן להמשך ניתוח.

---

## 📝 ניתוח דוחות ערעורים – דף 📝 BI ערעורים

בצד ימין בחר/י:

> **📝 BI – דוחות ערעורים**

במסך זה תמצא/י:

1. **רכיב העלאת קובץ ערעורים**
   - לדוגמה:  
     `forestry_and_trees_ararim2024- דוח ערערים.xlsx`

2. **מנגנון עיבוד אוטומטי המזהה:**
   - תאריך הערעור.
   - יישוב (מתוך כתובת/טקסט).
   - סיבת הערעור:
     - בנייה.
     - בטיחות.
     - מטרד.
     - אחר.
   - סטטוס ההחלטה:
     - התקבל.
     - התקבל חלקית.
     - נדחה.
     - לא נדון.
   - מספר עצים לשימור שניצלו.

3. **תוצרים ויזואליים:**
   - TOP-10 יישובים בכמות ערעורים.
   - יישובים מובילים בהצלחת ערעורים.
   - אחוזי הצלחה לפי סיבת ערעור.
   - רשימת ערעורים "גדולים" שהצילו הכי הרבה עצים.

---

## 🧭 סיכום מסלול עבודה

1. **איסוף קבצים**
   - ודא/י שכל ארבעת הקבצים קיימים:
     - דוחות כריתה מאוחדים ללא רשימות.
     - רשימת ערים לפי קודים.
     - רשימת עצים לפי קודים.
     - דוח ערעורים.

2. **הכנת הקבצים**
   - הפרדת רשימות ערים/עצים לקבצים נפרדים.
   - יצירת קובץ דוחות כריתה ללא גליונות רשימות.

3. **🧩 Merge & Export**
   - העלאת 3 קבצי הכריתה.
   - הרצת המיזוג.
   - הורדת `merged_forest_reports_FINAL_dates_fixed.xlsx`.

4. **📊 BI – כריתה**
   - טעינת קובץ המיזוג.
   - ניתוח דוחות הכריתה וייצוא גרפים/CSV.

5. **📝 BI – ערעורים**
   - טעינת דוח הערעורים.
   - ניתוח החלטות, הצלחות ושימור עצים.

6. **שילוב בדוחות והצגות**
   - שימוש בגרפים במצגות.
   - שימוש ב-CSV / Excel / Power BI לעבודה מתקדמת.

---
